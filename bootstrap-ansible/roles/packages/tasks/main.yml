---
- name: Update system
  dnf:
    name: "*"
    state: latest
    update_cache: yes

- name: Install core packages
  dnf:
    name:
      - git
      - curl
      - rsync
      - alacritty
      - kitty
      - vlc
      - gedit
      - flatpak
      - neovim
      - tmux
      - rpm
      - htop
      - zsh
    state: present

- name: Remove unwanted GNOME apps
  dnf:
    name:
      - gnome-calendar
      - gnome-logs
      - gnome-tour
      - gnome-contacts
      - gnome-photos
      - gnome-maps
      - gnome-characters
      - gnome-boxes
      - gnome-clocks
      - gnome-system-monitor
      - gnome-weather
      - totem
      - abrt
      - gnome-parental-controls
    state: absent

- name: Install Starship prompt (user installer)
  shell: curl -sS https://starship.rs/install.sh | sh
  args:
    creates: /usr/local/bin/starship
  become: false

- name: Ensure starship init is present in user's .bashrc
  lineinfile:
    path: "{{ home_dir }}/.bashrc"
    line: 'eval "$(starship init bash)"'
    state: present
    create: yes
  become: false
